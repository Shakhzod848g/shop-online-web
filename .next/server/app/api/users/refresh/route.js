"use strict";(()=>{var e={};e.id=823,e.ids=[823],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},70789:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>q,originalPathname:()=>j,patchFetch:()=>v,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>g});var s={};t.r(s),t.d(s,{POST:()=>d});var o=t(95419),i=t(69108),a=t(99678),n=t(46082),u=t.n(n),p=t(33850),x=t(71766),l=t(98984);async function d(e){try{let{db:r,reqBody:t}=await (0,x.N$)(p.Z,e);if(!t?.jwt)return l.NextResponse.json({message:"jwt is required",status:404});{let e=t.jwt,s={},o={},i=null;if(await u().verify(e,"securerefreshtoken",async e=>{let a=await (0,x.GY)(r,(0,x.aj)(t.jwt).email);if(!a){i={message:"Invalid jwt token"};return}if(e){"TokenExpiredError"===e.name&&(o=(0,x.X8)(a.name,a.email)),i=e;return}s=u().sign({name:a.name,email:a.email},"secureaccesstoken",{expiresIn:"10m"})}),i?.name==="TokenExpiredError")return l.NextResponse.json(o);if(i)return l.NextResponse.json({message:"Unauthorized",status:401,error:i});return l.NextResponse.json({accessToken:s,refreshToken:e})}}catch(e){throw Error(e.message)}}let m=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/users/refresh/route",pathname:"/api/users/refresh",filename:"route",bundlePath:"app/api/users/refresh/route"},resolvedPagePath:"C:\\Users\\hp\\Desktop\\online-shop\\app\\api\\users\\refresh\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:h,serverHooks:f,headerHooks:q,staticGenerationBailout:g}=m,j="/api/users/refresh/route";function v(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,791,604,382],()=>t(70789));module.exports=s})();