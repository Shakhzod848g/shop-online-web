{"version":3,"sources":["../src/index.ts","../src/AppProgressBar.tsx","../src/WithSuspense.tsx"],"sourcesContent":["import * as NProgress from 'nprogress';\nimport { Next13ProgressBar as ProgressBar, useRouter } from './AppProgressBar';\nimport withSuspense from './WithSuspense';\n\nexport interface Next13ProgressProps {\n  /**\n   * The color of the bar.\n   * @default \"#29D\"\n   */\n  color?: string;\n  /**\n   * The start position of the bar.\n   * @default 0.3\n   */\n  startPosition?: number;\n  /**\n   * The delay in milliseconds.\n   * @default 0\n   */\n  delay?: number;\n  /**\n   * The stop delay in milliseconds.\n   * @default 200\n   */\n  stopDelayMs?: number;\n  /**\n   * The height of the bar.\n   * @default 3\n   */\n  height?: number | string;\n  /**\n   * Whether to show the bar on shallow routes.\n   * @default true\n   */\n  showOnShallow?: boolean;\n  /**\n   * The other NProgress configuration options to pass to NProgress.\n   * @default null\n   */\n  options?: Partial<NProgress.NProgressOptions>;\n  /**\n   * The nonce attribute to use for the `style` tag.\n   * @default undefined\n   */\n  nonce?: string;\n\n  /**\n   * Use your custom CSS tag instead of the default one.\n   * This is useful if you want to use a different style or minify the CSS.\n   * @default (css) => <style nonce={nonce}>{css}</style>\n   */\n  transformCSS?: (css: string) => JSX.Element;\n  style?: string;\n}\n\nconst Next13ProgressBar = withSuspense(ProgressBar);\nexport { Next13ProgressBar, useRouter };\n\nexport default Next13ProgressBar;\n","import React, { useEffect } from 'react';\nimport NProgress from 'nprogress';\nimport { usePathname, useSearchParams, useRouter as useNextRouter } from 'next/navigation';\nimport { Next13ProgressProps } from '.';\nimport { NavigateOptions } from 'next/dist/shared/lib/app-router-context.shared-runtime';\n\ntype PushStateInput = [data: any, unused: string, url?: string | URL | null | undefined];\n\nexport const Next13ProgressBar = React.memo(\n  ({ color = '#0A2FFF', height = '2px', options, showOnShallow = false, delay = 0, style }: Next13ProgressProps) => {\n    const styles = (\n      <style>\n        {style ||\n          `\n          #nprogress {\n            pointer-events: none;\n          }\n          \n          #nprogress .bar {\n            background: ${color};\n          \n            position: fixed;\n            z-index: 1031;\n            top: 0;\n            left: 0;\n          \n            width: 100%;\n            height: ${height};\n          }\n          \n          /* Fancy blur effect */\n          #nprogress .peg {\n            display: block;\n            position: absolute;\n            right: 0px;\n            width: 100px;\n            height: 100%;\n            box-shadow: 0 0 10px ${color}, 0 0 5px ${color};\n            opacity: 1.0;\n          \n            -webkit-transform: rotate(3deg) translate(0px, -4px);\n                -ms-transform: rotate(3deg) translate(0px, -4px);\n                    transform: rotate(3deg) translate(0px, -4px);\n          }\n          \n          /* Remove these to get rid of the spinner */\n          #nprogress .spinner {\n            display: block;\n            position: fixed;\n            z-index: 1031;\n            top: 15px;\n            right: 15px;\n          }\n          \n          #nprogress .spinner-icon {\n            width: 18px;\n            height: 18px;\n            box-sizing: border-box;\n          \n            border: solid 2px transparent;\n            border-top-color: ${color};\n            border-left-color: ${color};\n            border-radius: 50%;\n          \n            -webkit-animation: nprogress-spinner 400ms linear infinite;\n                    animation: nprogress-spinner 400ms linear infinite;\n          }\n          \n          .nprogress-custom-parent {\n            overflow: hidden;\n            position: relative;\n          }\n          \n          .nprogress-custom-parent #nprogress .spinner,\n          .nprogress-custom-parent #nprogress .bar {\n            position: absolute;\n          }\n          \n          @-webkit-keyframes nprogress-spinner {\n            0%   { -webkit-transform: rotate(0deg); }\n            100% { -webkit-transform: rotate(360deg); }\n          }\n          @keyframes nprogress-spinner {\n            0%   { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `}\n      </style>\n    );\n\n    NProgress.configure(options || {});\n\n    const pathname = usePathname();\n    const searchParams = useSearchParams();\n\n    useEffect(() => {\n      NProgress.done();\n    }, [pathname, searchParams]);\n\n    useEffect(() => {\n      let timer: NodeJS.Timeout;\n\n      const startProgress = () => {\n        timer = setTimeout(NProgress.start, delay);\n      };\n\n      const stopProgress = () => {\n        clearTimeout(timer);\n        NProgress.done();\n      };\n\n      const handleAnchorClick = (event: MouseEvent) => {\n        const anchorElement = event.currentTarget as HTMLAnchorElement;\n\n        // Skip anchors with target=\"_blank\" | \"_top\" | \"_parent\" | \"_self\"\n        if (anchorElement.target === '_blank' || anchorElement.target === '_top' || anchorElement.target === '_parent')\n          return;\n\n        // Skip anchors with download attribute\n        if (anchorElement.hasAttribute('download')) return;\n\n        // target url without hash removed\n        const targetUrl = new URL(anchorElement.href);\n        const currentUrl = new URL(location.href);\n\n        // check if search params changed\n        const hasSearchParams = targetUrl?.searchParams?.toString() !== currentUrl?.searchParams?.toString();\n        const paramsChanged = hasSearchParams && targetUrl?.search !== currentUrl?.search;\n        const isSameUrl = targetUrl?.pathname === currentUrl?.pathname && !paramsChanged;\n\n        // detect ctrl/cmd option/alt shift click\n        if (event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) return;\n\n        if (showOnShallow && isSameUrl) return;\n        if (isSameUrl) return;\n\n        startProgress();\n      };\n\n      const handleMutation: MutationCallback = () => {\n        const anchorElements = document.querySelectorAll('a');\n        const validAnchorELes = Array.from(anchorElements).filter((anchor) => {\n          if (anchor.href.startsWith('tel:+') || anchor.href.startsWith('mailto:')) return false;\n          return anchor.href && anchor.target !== '_blank';\n        });\n        validAnchorELes.forEach((anchor) => anchor.addEventListener('click', handleAnchorClick));\n      };\n\n      const mutationObserver = new MutationObserver(handleMutation);\n      mutationObserver.observe(document, { childList: true, subtree: true });\n\n      window.history.pushState = new Proxy(window.history.pushState, {\n        apply: (target, thisArg, argArray: PushStateInput) => {\n          stopProgress();\n          return target.apply(thisArg, argArray);\n        },\n      });\n    }, []);\n\n    return styles;\n  },\n  () => true\n);\n\nexport function useRouter() {\n  const router = useNextRouter();\n  const pathname = usePathname();\n\n  function push(href: string, options?: NavigateOptions) {\n    const targetUrl = new URL(href, location.href);\n    const currentUrl = new URL(location.href);\n    const hasSearchParams = targetUrl?.searchParams?.toString() !== currentUrl?.searchParams?.toString();\n    const paramsChanged = hasSearchParams && targetUrl?.search !== currentUrl?.search;\n    if (targetUrl.pathname === pathname && !paramsChanged) return Promise.resolve(true);\n    NProgress.start();\n    return router.push(href, options);\n  }\n\n  function replace(href: string, options?: NavigateOptions) {\n    const targetUrl = new URL(href, location.href);\n    if (targetUrl.pathname === pathname) return Promise.resolve(true);\n    NProgress.start();\n    return router.replace(href, options);\n  }\n\n  return { ...router, push, replace };\n}\n","import React from 'react';\n// HOC for suspense\nexport default function withSuspense(Component: React.FC) {\n  return function WithSuspenseComponent(props: any) {\n    return (\n      <React.Suspense>\n        <Component {...props} />\n      </React.Suspense>\n    );\n  };\n}\n"],"mappings":"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","names":["src_exports","__export","Next13ProgressBar","src_default","useRouter","__toCommonJS","import_react","import_nprogress","import_navigation","Next13ProgressBar","React","color","height","options","showOnShallow","delay","style","styles","NProgress","pathname","searchParams","timer","startProgress","__name","stopProgress","handleAnchorClick","event","anchorElement","targetUrl","currentUrl","paramsChanged","isSameUrl","handleMutation","anchorElements","anchor","target","thisArg","argArray","useRouter","router","useNextRouter","push","href","replace","import_react","withSuspense","Component","__name","props","React","Next13ProgressBar","withSuspense","src_default","Next13ProgressBar"]}